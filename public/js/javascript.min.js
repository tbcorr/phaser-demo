var BlockShape=function(game,x,y,blocks,blockSize){Phaser.Sprite.call(this,game,x,y);this.blocks=blocks;this.blockSize=blockSize;this.isOverlapping=false;this.inputEnabled=true;this.input.enableDrag();this.input.enableSnap(this.blockSize,this.blockSize,true,true);this.setup()};BlockShape.prototype=Object.create(Phaser.Sprite.prototype);BlockShape.prototype.constructor=BlockShape;BlockShape.prototype.setup=function(){this.renderCollisionState(true)};BlockShape.prototype.renderCollisionState=function(){var graphics=this.game.add.graphics();if(this.isOverlapping){graphics.beginFill(65280)}else{graphics.beginFill(16711680)}this.blocks.forEach(function(block){graphics.drawRect(block.x*this.blockSize,block.y*this.blockSize,this.blockSize,this.blockSize)},this);this.loadTexture(graphics.generateTexture());graphics.destroy()};var DemoState=function(game){this.blockShapeOne=null;this.blockShapeTwo=null;this.blockShapeThree=null;this.blockShapeFour=null};DemoState.prototype=Object.create(Phaser.State.prototype);DemoState.prototype.constructor=DemoState;DemoState.prototype.create=function(){this.game.physics.startSystem(Phaser.Physics.ARCADE);this.grid=new GridShape(this.game,100,100,50,10,10);var blocks=[{x:0,y:0},{x:0,y:1},{x:1,y:1}];this.blockShapeOne=new BlockShape(this.game,50,50,blocks,50);blocks=[{x:0,y:0},{x:1,y:0},{x:0,y:1},{x:1,y:1}];this.blockShapeTwo=new BlockShape(this.game,400,50,blocks,50);blocks=[{x:0,y:0},{x:1,y:0},{x:2,y:0},{x:0,y:1},{x:1,y:1},{x:2,y:1}];this.blockShapeThree=new BlockShape(this.game,50,400,blocks,50);blocks=[{x:0,y:0},{x:0,y:1},{x:1,y:1},{x:2,y:1},{x:3,y:1},{x:3,y:2}];this.blockShapeFour=new BlockShape(this.game,200,200,blocks,50);this.grid.addChild(this.blockShapeOne);this.grid.addChild(this.blockShapeTwo);this.grid.addChild(this.blockShapeThree);this.grid.addChild(this.blockShapeFour);this.game.add.existing(this.grid);this.grid.center()};"use strict";var vWidth=1024;var vHeight=768;var game=new Phaser.Game(vWidth,vHeight,Phaser.AUTO,"canvas-wrap");game.state.add("demo",DemoState);game.state.start("demo");var GridShape=function(game,x,y,tileSize,rows,columns){Phaser.Sprite.call(this,game,x,y);this.tileSize=tileSize;this.rows=rows;this.columns=columns;this.setup()};GridShape.prototype=Object.create(Phaser.Sprite.prototype);GridShape.prototype.constructor=GridShape;GridShape.prototype.setup=function(){var graphics=this.game.add.graphics();graphics.lineStyle(1,16777215);for(var i=0;i<this.rows+1;i++){for(var j=0;j<this.columns+1;j++){var x0=Math.max(j*this.tileSize-1,0);var x1=Math.max(j*this.tileSize-1,0);var y1=Math.max(this.tileSize*this.rows-1,0);graphics.moveTo(x0,0);graphics.lineTo(x1,y1)}var y0=Math.max(i*this.tileSize-1,0);var x1=Math.max(this.tileSize*this.columns-1,0);var y1=Math.max(i*this.tileSize-1,0);graphics.moveTo(0,y0);graphics.lineTo(x1,y1)}this.loadTexture(graphics.generateTexture());graphics.destroy()};GridShape.prototype.center=function(){this.x=this.game.world.centerX-Math.floor(this.width/2);this.y=this.game.world.centerY-Math.floor(this.height/2)};